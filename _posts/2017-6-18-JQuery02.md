---
layout: post
title: JQuery
tags:
- java

categories: java
description: JQuery
---



## 筛选
```
选择器可以完成功能，筛选提供相同函数。
	选择器	:first
	筛选	first()
对比：
	$("div:first")	直接获得第一个div （永远只能操作第一个）
	$("div").first()	先获得所有的div，从所有的中筛选出第一个。 （可以操作第一个，也可以操作所有）
```
###### 过滤
|表达式|备注|
|-----|----|
|eq(index | -index) | 类型 :eq() index：正数，从头开始获得指定索引的元素。这个元素的位置是从0算起。0表示第一个-index：负数，从尾开始获得指定索引的元素。1算起。 -1表示最后一个|
|first()	| 第一个  :first|
|last()	| 最后一个  :last|
|is()	|	判断|
|hasClass()	| 判断是否是指定class其实就是 is("." + class)|
|filter() | 筛选出与指定表达式匹配的元素集合 |
|not()	| 将指定内容删除|
|has()  | 子元素是否有 |
|slice(start , end) | 截取元素 ，[2,4)  --> 2,3 |
|map() | jQuery对象 拆分成  jQuery对象数组 |

```javascript
<script type="text/javascript">
    $(document).ready(function () {
//        选择索引值等于3的元素
        $("#b1").click(function () {
            $("div").eq(3).css("background-color","#96ffb8")
        })
//        选择第一个div元素
        $("#b2").click(function () {
            $("div").first().css("background-color","#679755")
        })
//        选择最后一个div元素
        $("#b3").click(function () {
            $("div").last().css("background-color","#ff6da2").show()

        })
//        id=one div样式是否是one
        $("#b4").click(function () {
            alert($("div#one").hasClass("one"))
        })
//        选择class为none的所有div
        $("#b5").click(function () {
            //$("div.none").css("background-color","#525f97").show()
            $("div").filter(".none").css("background-color","#525f97").show()
        })
//        样式为hide div 下一个兄弟是否是span
        $("#b6").click(function () {
            alert($("div.hide").next().is("span"))
        })
//        选择所有div中含有div的
        $("#b7").click(function () {
            $("div").has("div").css("background-color","#fcff58")
        })
//        选择样式为one div 子元素中没有title属性的父div
        $("#b8").click(function () {
            //$("div.one").not("[title]").css("background-color","#328baa")
            //$("div.one").children().not("[title]").parent().css("background-color","#7a6bff")
            $("div.one").not( $("div.one").children().filter("[title]").parent()).css("background-color","#7a6bff")
        })
//        选择所有号为3,4的div
        $("#b9").click(function () {
            $("div").slice(3,4).css("background-color","#ff023a")
        })
        //把所有的input的value拿来用，链接追加到p里面
        $("#b10").click(function () {
            $("p").append($("input").filter("[type='hidden']").map(function () {
                return $(this).val()
            }).get().join(","))
        })
    })
  </script>
```

###### 查找
```
<A>
	<B>
		<C></C>
		<D></D>
		<E></E>
		<F></F>
	</B>
</A>
```
|表达式|备注|
|-----|----|
|B.children([...])  | 获得所有的子元素。CDEF |
|A.find(D) | 从指定的区域查询指定元素。D |
|D.next()  |	下一个兄弟。E |
|D.nextAll() | 后面的所有兄弟。EF |
|E.prev()  |	上一个兄弟。D  （previous） |
|E.prevAll() | 前面的所有兄弟。CD |
|E.siblings() | 所有兄弟。CDF |
|E.parent() | 父元素。B |
|E.closest(A)  | 向上获得指定的父元素（含自己），如果获得返回一个对象，如果没有没有对象|
|C.nextUntil(E) | 获得后面所有兄弟，直到指定条件位置。DE |
|F.prevUntil(D) | 获得前面所有兄弟，直到指定条件位置。DE |
|E.parents() |  获得所有的父元素。AB |

```
closest和parents的主要区别是：
1，前者从当前元素开始匹配寻找，后者从父元素开始匹配寻找；
2，前者逐级向上查找，直到发现匹配的元素后就停止了，后者一直向上查找直到根元素，然后把这些元素放进一个临时集合中，再用给定的选择器表达式去过滤；
3，前者返回0或1个元素，后者可能包含0个，1个，或者多个元素。
```

```javascript
<script type="text/javascript">
  	$(document).ready(function(){
        //选择 id=two 所有子元素"  id="b1"
        $("#b1").click(function () {
            $("#two").children().css("background-color","#d6ffe1")
        })
        //选择 id=two 子元素title=other 元素 "  id="b2"
        $("#b2").click(function () {
            $("#two").children("[title='other']").css("background-color","#4098a9")
        })
        //选择 id=two 下一个兄弟"  id="b3"
        $("#b3").click(function () {
            $("#two").next().css("background-color","#ff6da2")
        })
        //选择 id=two 后面的所有兄弟"  id="b4"
        $("#b4").click(function () {
            $("#two").nextAll().css("background-color","#fcff58").show()
        })
        //选择 id=two 上一个兄弟"  id="b5"
        $("#b5").click(function () {
            $("#two").prev().css("background-color","#d6ffe1")
        })
        //选择 id=two 前面的所有兄弟"  id="b6"
        $("#b6").click(function () {
            $("#two").prevAll().css("background-color","#7a6bff").show()
        })
        //选择 id=two 所有兄弟"  id="b7"
        $("#b7").click(function () {
            $("#two").siblings().css("background-color","#90ffa1").show()
        })
        //选择 id=two 父元素"  id="b8"
        $("#b8").click(function () {
            $("#two").parent().css("background-color","#ff023a")
        })
        //选择 title=tesst 父元素
        $("#b9").click(function () {
            $("div[title='tesst']").closest("body").css("background-color","#7a6bff")
        })
    });
  </script>¡
```

###### 串联
> 将多条语句，改成一条。（得瑟代码）

|方法|说明|
|---|----|
|A.add(B) | 将A和B组合一个对象 。类型 $("A,B")|
|andSelf() | 将之前对象添加到操作集合中 |
|end() |回到最近的一个"破坏性"操作之前 破坏性 操作对象改变|
|contents()  | 获得所有的子节点（子元素 和 文本）|

```
	A.children().andSelf()  
   	A	孩子    孩子和A

   	A.children().children().end() .end()  
	A   孩子   孙子		孩子  A
```

```
<script type="text/javascript">
    $(document).ready(function () {
        //选择 id=one和two 的div"  id="b1"
        $("#b1").click(function () {
           // $("#one,#two").css("background-color","#ff9599")
            $("#one").add($("#two")).css("background-color","#ff9599")
        })
        //选择id=one 所有的孩子，以及one自己"  id="b2"
        $("#b2").click(function () {
            $("#one").children().andSelf().css("background-color","#90ffa1")
        })
        //选择id=one 所有的孩子，设置颜色为红，设置one自己为黄"  id="b3"
        $("#b3").click(function () {
            $("#one").children().css("background-color","red").end().css("background-color","yellow")
            //$("#one").children().css("background-color","red").parent().css("background-color","yellow")
           // $("#one").css("background-color","yellow").children().css("background-color","red")
        })
        //获得id=two 子节点个数"  id="b4"
        $("#b4").click(function () {
            alert($("#two").contents().length)
        })
    })
  </script>
```

###### qq分组
```html
<script type="text/javascript">
		$(document).ready(function(){
            //所有分组列表项默认都是隐藏
			//分组(span)可以点击 控制下面的列表项显示或隐藏
			//当前分组列表显示，其他分页要隐藏 只有一个是显示状态
			$("div").children().filter("a").hide().prev("span").click(function () {
				$(this).nextAll("a").toggle().parent().siblings().find("a").hide();
            })
		});
	</script>

	<div>
			<span>追求中</span>
			<a>娇娇</a>
			<a>婷婷</a>
			<a>冉冉</a>
		</div>
		<div>
			<span>已交往</span>
			<a>蕊蕊</a>
			<a>小雨</a>
			<a>琪琪</a>
		</div>
		<div>
			<span>已分手</span>
			<a>圆圆</a>
			<a>吖吖</a>
			<a>洋洋</a>
			<a>纯纯</a>
		</div>
```

## 事件
####### 常见事件总结
|方法|说明|
|---|----|
|blur |失去焦点|
|hange | select 改变|
|click |单击|
|dblclick | 双击|
|error |页面出现错误|
|focus| 获得焦点|
|focusin ||
|focusout||
|keydown |键盘按下|
|keypress |键盘按|
|keyup |键盘弹起|
|mousedown|鼠标按下|
|mouseenter||
|mouseleave||
|mousemove|鼠标移动|
|mouseout|鼠标移出|
|mouseover|鼠标移入|
|mouseup|鼠标弹起|
|resize|改变大小|
|scroll|滚动|
|select|选择|
|submit|提交|
|upload|页面卸载|

```javascript
<script type="text/javascript">
		$(document).ready(function(){
			$("#e01").blur(function(){
				$("#textMsg").html("文本框失去焦点：blur");
			}).focus(function(){
				$("#textMsg").html("文本框获得焦点：focus");
			}).keydown(function(){
				$("#textMsg").append("键盘按下：keydown");
			}).keypress(function(event){
				$("#textMsg").append("键盘按下：keypress");
			}).keyup(function(){
				$("#textMsg").append("键盘按下：keyup");
			}).select(function(event){
				//支持谷歌
				var sub = $(this).val().substring(event.target.selectionStart,event.target.selectionEnd);
				$("#textMsg").html("文本内容被选中：select ， " + sub);
			});

			var i = 0;
			$("#e02").mouseover(function(){
				$("#divMsg").html("鼠标移上：mouseover");
			}).mousemove(function(){
				$("#divMsg").html("鼠标移动：mousemove , " + i++ );
			}).mouseout(function(){
				$("#divMsg").html("鼠标移出：mouseout");
			}).mousedown(function(){
				$("#divMsg").html("鼠标按下：mousedown");
			}).mouseup(function(){
				$("#divMsg").html("鼠标弹起：mouseup");
			});

			$("#e03").click(function(){
				$("#buttonMsg").html("单击：click");
			}).dblclick(function(){
				$("#buttonMsg").html("双击：dblclick");
			});

		});
	</script>
```

```
jQuery 提供额外的事件，用于完善javascript缺失的
focusin 和 focusout
	focusin 获得焦点。js focus。
		focusin事件跟focus事件区别在于，他可以在父元素上检测子元素获取焦点的情况。
	focusout 失去焦点。js blur。
		focusout事件跟blur事件区别在于，他可以在父元素上检测子元素失去焦点的情况。

mouseenter 和 mouseleave
    mouseenter 鼠标移入。js mouseover
		与 mouseover 事件不同，只有在鼠标指针穿过被选元素时，才会触发 mouseenter 事件。如果鼠标指针穿过任何子元素，同样会触发 mouseover 事件。

mouseleave 鼠标移出。js mouseout
		与 mouseout 事件不同，只有在鼠标指针离开被选元素时，才会触发 mouseleave 事件。如果鼠标指针离开任何子元素，同样会触发 mouseout 事件。
```

```javascript
	<script type="text/javascript">
		$(document).ready(function(){
			//js focus fucus父元素不能检测到子元素获得焦点
//			$("#outerDiv").focus(function () {
//				alert("124")
//            })
			$("#outerDiv").focusin(function () {
				alert("outerDiv")
            })
		});
	</script>

	<script type="text/javascript">
		$(document).ready(function(){
			var i= 0;
//			$("#outerDiv").mouseover(function () {
//			    $("#showSpan").html(i++)
//            })
            $("#outerDiv").mouseenter(function () {
                $("#showSpan").html(i++)
            })
		});
	</script>
```


##	页面加载

````

方式1：标准api
$(document).ready(function(){

});
等效
jQuery(document).ready( fn );

方式2：简化版
$(function(){
});
登录
jQuery(function(){
});

源码分析（了解）
步骤一：回顾js 函数创建
	方式1：function abc(){};   abc();
	方式2：var abc = function(){} ;   abc();
	$( fn )  == jQuery( fn )  == new jQuery.fn.init( fn )

步骤二： init( fn )  -->  rootjQuery.ready( fn )


步骤三：

	总结：
		$( fn )  --> init( fn )  --> jQuery(document).ready( fn )
```

##	事件绑定
|方法|说明|
|----|---|
|bind(type ,fn) | 给当前对象绑定一个事件。例如：A.bind("click", fn );  类型：A.click( fn )|
|unbind(type ) | 解绑bind绑定事件|
|one(type ,fn ) |给当前对象绑定一次事件|
|on(events , fn) | 提供绑定事件处理程序所需的所有功能。完成3个方法功能.bind(), .delegate(), 和 .live()|
|off(events) |解绑|
|trigger(type) |在每一个匹配的元素上触发某类事件。例如：A.trigger("submit")  ,类似 A.submit()|
|triggerHandler(type) 在每一个匹配的元素上触发某类事件。但不会执行浏览器默认动作，也不会产生事件冒泡|
|live(type , fn) | 绑定事件，之后动态添加同样的成员，也具有相同的事件 |
|die(type) | 解绑事件 |
|hover(over , out) | 简化版，鼠标移入和移出  ，A.mouseover( fn ).mouseout( fn)  简化 A.hover( fn , fn ) |
|toggle( fn , fn , fn ,...) 执行click事件，每点击一次执行一个fn|
###### 事件处理
```javascript
<script type="text/javascript">
		$(function(){
            //1只能点击一次，之后失效"
			$("#h01").one("click",function () {
				alert("你只能看到我一次")
            })
            //2可以点击多次"
			$("#h02").bind("click.a",function () {
				alert("每次都能看见我")
            })
			//别名 格式 事件.别名
			$("#h02").bind("click.b",function () {
				alert("次次都是我")
            })
            //3解绑2"
			$("#h03").click(function () {
				$("#h02").unbind("click.b")
            })
            //4 添加一个按钮，样式为myClass，且拥有相同的事件" class="myClass"
			$(".myClass").live("click",function () {
				$("body").append("<input type='button' class='myClass'value='血脉觉醒'/>")
            })
            //5 解绑4"
			$("#h05").click(function () {
				$(".myClass").die("click")
            })
		});
	</script>
```
###### 事件处理
```javascript
<script type="text/javascript">
		$(function(){
			$("#e01").toggle(function(){
			    alert("报数1")
			},function(){
			    alert("报数2")
			})
			$("#e02").hover(function () {
				$("#divMsg").html("over")
            },function () {
				$("#divMsg").html("out")
            })
		});
	</script>
```
###### 事件案例
```html
<script type="text/javascript">
	$(function(){
	    $(".tooltip").mouseover(function (event) {
            var $new=$("<div id='tooltip'></div>")
            var title=$(this).data("title")
            if(! title){
                title=$(this).attr("title")
                $(this).removeAttr("title")
                $(this).data("title",title)
            }
            $new.appendTo("body")
     //           .html($(this).attr("title"))
                .html(title)
                .offset({"left":event.pageX+5,"top":event.pageY-20})
                .show()
            $(this).removeAttr("title")
        }).mousemove(function (event) {
           $("#tooltip").offset({"left":event.pageX+5,"top":event.pageY-20})
        }).mouseout(function () {
            $(this).attr("title",$("#tooltip").html())
           $("#tooltip").remove()
        })
	});
</script>
<p><a href="#" class="tooltip" title="这是我的超链接提示1.">提示1.</a></p>
<p><a href="#" class="tooltip" title="这是我的超链接提示2.">提示2.</a><
```

## 效果|动画
|效果|说明|
|---|----|
|1.基本|通过改变元素 高度和宽度 进行显示或隐藏|
|show(speed,fn)| 显示 参数1：speed速度。显示的时间，单位：毫秒。固定字符串：("slow","normal", or "fast") 参数2：fn 回调函数。动画效果完成之后回调函数|
|hide() |隐藏|
|toggle() |切换|
|2.滑动|通过改变元素 高度  进行显示或隐藏|
|slideDown() | 显示 |
|slideUp() |隐藏|
|slideToggle() |切换|
|3.淡入淡出|通过改变元素  透明度  进行显示或隐藏|
|fadeIn()| 显示|
|fadeOut() | 隐藏 |
|fadeToggle() | 切换 |
|fadeTo(speed,opacity,fn) | 指定透明度 参数2：opacity 透明度，一个0至1之间表示透明度的数字 |

###### 淡入淡出
```javascript
	<script type="text/javascript">
		$(document).ready(function(){
			$("#b1").click(function(){
				$("#b1Div").toggle("1000");
			});
			$("#b2").click(function(){
				$("#b2Div").slideToggle("slow");
			});
			$("#b3").click(function(){
				$("#b3Div").fadeToggle(2000,function () {
					alert("完成")
                });
			});
		});
	</script>
```


## Ajax
> ajax ：异步请求，浏览器地址栏不改变，进行局部刷新。
###### ajax 流程分析
```

 jQuery程序             ajax引擎          服务器
    |						|				|
    |						|				|
    |--请求   				|				|
    |	|--路径+参数  ----->   ----------->	|--Servlet
    |						|					 |--获得请求方式
    |						|					 |--获得请求参数
    |						|					 |--业务相关
    |						|							|
编写回调，获得json  <----  回调函数	(json)	<------------   |--响应数据 JSON

```

###### jQuery 的ajax
```

|--第一层
|	 |
|	 |--$.ajax(...) 最底层ajax请求，编写最复杂，完成功能最全的。
|
|--第二层
|	 |
|	 |--load() 、$.get() 、$.post()  开发中常用3个
|
|--第三层
|	 |
|	 |--$.getJSON()  、$.getScript() 高级开发
|		    |
|			|--$.getJSON()
|			|		|--可以完成js“跨域”请求
|			|		|--域名：域名+端口+项目，js默认不能跨域请求。
|			|
|			|--$.getScript()
|					|--动态加载js文件
|					|--之前用< script src="">加载页面时，一并加载js文件
|

```
###### load()

```javascript
	<script type="text/javascript">
		$(function(){
			$("input").click(function () {
			    var url="/sendDataServlet";
			    var params={"username":"jack","password":"1234"}
                /**load()函数，必须使用jquery对象
				 * 参数1:url请求路径
				 * 参数2:data请求参数
				 * 参数3:回调函数
				 * 如果没有参数 发送get
				 * 如果有请求参数 发送post
				 * load永远获得是字符串
                 */
                $(this).load(url,params,function (data) {
                    var json =eval("("+data+")")
					alert(json.message)
                })
            })
		});
	</script>
```

###### $.get(),$.post()

```javascript
<script type="text/javascript">
		$(function(){
			$("input").click(function () {
			    var url="/sendDataServlet";
			    var params={"username":"jack","password":"1234"}
                /**$.get() 全局函数,发送get请求
				 * 格式 jQuery.get(url,[params],[callback],[])
				 * get请求不适合发中文数据,存在请求的中文乱码，必须手动解决 new String("iso-8859-1","utf-8")
				 * 响应数据,如果使用application/json;charset=utf-8 jQeury自动转换成json对象
				 * 响应数据,如果是text/html;charset=utf-8 返回的是字符串
				 * 参数4:返回内容格式[xml,html,script,json,text,_default]
                 */
                $.get(url,params,function (data) {
					alert(data.message)
                },"json")
                //$.post(url,params,function (data) {
				//	alert(data.message)
                //},"json")
            })
		});

	</script>
```

###### $.ajax()
```javascript
<script type="text/javascript">
		$(function(){
				var url="/sendDataServlet";
			    var params={"username":"jack","password":"1234"}
			 /**$.ajax() 底层功能最强大
				 * 参数setting:设置所有的参数
				 * url:发送请求地址
				 * data:请求参数
				 * type:请求方法
				 * success:回调函数
				 * error:请求失败回调函数
				 * dataType:预期服务器类型 xml,html,script,json,jsonp,text
                 */
				$.ajax({
					"url":url,
					"data":params,
					"type":"POST",
					"success":function(data){
					    alert(data.message)
					},
					"error":function(){
					    alert("服务器繁忙，请稍后重试")
					},
					"dataType":"json"
				})

		}
</script>			
```

## 其他
###### 表单序列化

* serialize()
将表单中所有选中项拼凑成一个字符串。类似get请求参数
例如：username=jack&password=1234&gender=man&....

* serializeArray()
将表单中所有选中项拼凑一个json数组
[{"name":"username","value":"zhangsan"},{"name":"password","value":"12345"}]


* 事件冒泡
子元素执行时，一并触发父元素相同的事件
event.stopPropagation()

```javascript
	<script type="text/javascript">
		$(document).ready(function(){
			$("#outerDiv").click(function () {
				alert("outerDiv")
            })
			$("#innerDiv").click(function (event) {
				alert("innerDiv")
				//阻止事件冒泡
				//方式一 return false;
				//方式二
				event.stopPropagation();
            })
		});
	</script>
```


* 浏览器默认动作
event.preventDefault()

```javascript
<script type="text/javascript">
		$(document).ready(function(){
			$("a").click(function (event) {
				alert("弹弹弹弹")
				//阻止浏览器默认行为
				//方式一
				//return false
				//方式二
				event.preventDefault()
            })
		}
</script>
```

###### 动态加载案例
```javascript
<script type="text/javascript">
		$(document).ready(function(){
			for(var i=0;i<10;i++){
			    createDiv()
			}
			$(window).scroll(function () {
			    //滚过的高度
				var wt = $(this).scrollTop();
				//整个文档的高度
				var dh=$(document).height();
				//整个窗口的高度
				var wh=$(this).height();
				//当接近底部 添加
				if(wt+wh+100>dh){
				    createDiv();
				}
				$("#showDiv").html("wt: "+wt+" , dh: "+dh+" , wh: "+wh)

            })
		});
		var num=1;
		function createDiv(){
		    var $div=$("<div class='newDiv'>"+num+++"</div>")
			$div.appendTo("body")
		}
	</script>
```

###### 抽奖案例
```javascript
<script type="text/javascript">
		$(document).ready(function(){
			for(var i=0;i<5;i++){
			    createDiv()
			}
			setInterval(function () {
                //第一个先隐藏
                $("div:first").slideUp(500,function () {
                    $(this).appendTo("body").slideDown(500);
                })
            },500)
		});
		var num=1;
		function createDiv(){
		    var $div=$("<div class='newDiv'>"+num+++"</div>")
			$div.appendTo("body")
		}
	</script>
```

## 跨域
> 2个不同的域名通信
> jquery 默认使用jsonp
####### js跨域
```
1.服务器一发送请求
<script scr="http://域名:端口/项目？callback=回调方法名"></script>
2.服务器二接受请求响应数据
响应的格式为resp.getWriter.println(回调方法名+"("+jsonString+")");
```
###### jQuery跨域
```
$.getJson(http://域名:端口/项目?callback=?,function(){

})
```
